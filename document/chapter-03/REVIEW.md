# 3. 코드에서 나는 악취 Review

***

## 3.6 가변 데이터 (Mutable Data)

이 규칙은 변수를 이곳 저곳에서 변경할 수 있다면 나중에 문제가 생길 때 찾기가 힘드니까 변경을 위한 코드는 따로 분리 해놓는게 중요하다는 원리인 것 같다. 

어떠한 다른 객체가 그 클래스에 변수를 직접 참조해서 변경하는 그런 경우가 굉장히 끔찍한 악취 중에 하나라고 생각한다. 

API 를 만들 때는 __질의와 변경 함수 분리하기__ 라는 규칙이 있다.  

이 원칙은 클린 코드에서도 봤늗네 __가장 근간이 되는 이유는 함수는 한번에 한 가지 일을 해야 이해하기 쉽다.__ 때문이다.

질의와 변경 둘 다 가지고 있다면 함수 자체가 역할이 두 개라고 볼 수 있을듯.

예전 TDD 에서 __참조를 값으로 바꾸기__ 인 값 객체 사용성에 대해서 논의한 적이 있던거 같은데 이 값 객체의 사용은 __변경을 해도 원본을 보장시키고 싶을 때 사용한다.__ 였다. 

이런 패턴을 적용하면 안되는 경우가 여러 객체에서 참조를 공유해야 하는 경우에는 적용하면 안된다. 


***

## 3.7 뒤엉킨 변경 (Divergent Change)

변경 포인트를 하나로 고정시키도록 하는게 중요하다. 라는 것 그러므로 맥락별로 적절한 모듈을 만들어 놓는게 중요하다. 라는 의미가 핵심인 것 같다. 

그리고 이런 맥락 별로 모듈을 만들기 위해서 적절한 기법들에 대해서 소개했다. 

일단 맥락을 분리 시켜 놓는 것 부터 시작. 요것을 잘해야한다. 즉 맥락별로 클래스를 나누는 것일 수도 있겠지. 

근데 이게 초기에는 어려울 수 있으니까. 뒤늦게 맥락을 발견할 때 적용하는 기법들을 소개해줬다. 

그게 바로 맥락을 나누는 단계 쪼개기 기법. 

단계 쪼개기 기법을 사용할 때 관련있는 메소드들을 모아야 하는데 이 메소드들이 모아져있지 않다. 라고 한다면 하나의 함수에서 여러 맥락을 거치는 함수일 것이고 이는 함수 추출하기를 통해서 해결하면 된다 라는 것.

***

## 3.8 산탄총 수술 (Shotgun Surgery)

이 기법은 하나를 고치면 여러 곳을 동시에 고쳐야 하는 경우에 적용하는 기법을 말한다. 

여러 곳을 고쳐야 한다는 말은 이것들이 하나의 맥락이였기 때문이라는 말이므로 모듈로 만들어서 관리를 하라 라는 말이다. 

모듈로 만들기 위해서 여러가지 기법들을 소개하는데 __함수 옮기기__ __필드 옮기기__ 이런 기법들이 있고 

새로운 클래스를 만들고 여기에다가 메소드를 옮기는 기법을 적용하면 된다.

그 다음 연관된 데이터가 있고 그걸 호출하는 메소드도 연관되서 호출된다면 이를 변환 함수로 만드는 것도 고려해볼 수 있다.  

변환 함수 (원본 데이터를 입력 받아서 필요한 정보를 모두 도출한 뒤 출력 데이터의 필드에 넣어서 반환하는 함수)